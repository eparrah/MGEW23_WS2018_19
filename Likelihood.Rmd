---
title: "R Markdown - Likelihood"
author: "Martina Rosskopf & Nina Golombek"
date: "12 November 2018"
output:
  pdf_document: default
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Task:

Tsunami scientist Trevor rolls some dice and tells you that the added result is 17. 
How many dice did Trevor roll? Write some R code to find this out! Think of an example 
that applies this problem to natural hazards!


```{r}
# To get a result of exactly 17, we need at least 3 dices and max. 17 dices
# Thus we can find simulations for each No. dices (between 3-17)

sum(sample(1:6, 3, replace = TRUE))   # The sample function includes only whole numbers 
sum(sample(1:6, 4, replace = TRUE))   # Here: between 1-6 for a set number of dices (between 3-17)
sum(sample(1:6, 5, replace = TRUE))
sum(sample(1:6, 6, replace = TRUE))
sum(sample(1:6, 7, replace = TRUE))
sum(sample(1:6, 8, replace = TRUE))
sum(sample(1:6, 9, replace = TRUE))
sum(sample(1:6, 10, replace = TRUE))
sum(sample(1:6, 11, replace = TRUE))
sum(sample(1:6, 12, replace = TRUE))
sum(sample(1:6, 13, replace = TRUE))
sum(sample(1:6, 14, replace = TRUE))
sum(sample(1:6, 15, replace = TRUE))
sum(sample(1:6, 16, replace = TRUE))
sum(sample(1:6, 17, replace = TRUE))

```

###In other words:

L(No. Dices | result = 17)   --> Number of dice depends on the condition that the result = 17

###Ideas how to code this:

1. A Loop --> *If* the Sum = 17, R shall record the number of Dice --> *Else* repeat the experiment  
2. A Loop --> The Sum of experiments from 3-17 --> plot into a histogram 


###Note:

The statistical expectation for each dice is 3.5
Thus, in order to reach ~17, five dices are most likely (5* 3.5 = 17.5 --> closest to 17)

```{r}

n <- 100000                                       # Number of repititions      
menge <- rep(0,15)                                # Name vector "Menge", only from 0-15 because                                                                           1 & 2 are not included but we want to start with 1
for(i in 3:17){                                   # for-Loop works if we know the number of runns 
  vec <- sample(1:6, n * i, replace = TRUE)       # Define Vector with random numbers between 1-6 &                                                                       n * 1 collumns 
  mat <- matrix(data = vec, nrow = n, ncol = i)   # convert vector into a matrix
#  for(j in 1:n){                                   # for-Loop to sum up the rows in the matrix 
#    if(sum(mat[j,]) == 17){                        # If-command to ask for those results = 17 (TRUE)
#      menge[i-2] <- menge[i-2]+1                   # Menge i-2 to jump to the first collumn                                                                                if this is < 17, continue counting until > 17
#    }
#  }
   menge[i-2] <- sum(rowSums(mat) == 17)         # rowSums(mat) creates the sum for each row                                                                             ask how many entries = 17 
}                                                # results in a vector with TRUE (1) and FALSE (0) entires 
                                                 # Sum of TRUE´s is documented 

# Plot
x <- 3:17
plot(x, menge, type = "h", col="coral", lwd=10,           # Values of the X,Y-Axis 
     xlim = c(3,17) ,                                     # Sets the limits for the X-Axis
     main = "Likelihood of Dices",                        # Diagram Title 
     xlab = "Number of Dices",                            # X-Axis Title
     ylab = "Number of Runs",                                 # Y-Axis Title
     cex.lab = 1.5, cex.main = 1.5)                       # Font size of Titles 
```


## OR

```{r}
min_dice <- 3                         # Minimum Number of dices
max_dice <- 17                        # Maximum Number of dices
n <- 5000                             # Number of Experiments

nroll <- sample(min_dice:max_dice, n, replace = TRUE)

# Create an empty output container (vector) for my results
likely_roll <- rep(NA, n)                             # generates n = 5000 empty entries

# Loop through n experiments
for (i in 1:n) {
  if (sum(sample(1:6, nroll[i], replace = TRUE)) == 17){
    likely_roll[i] <- nroll[i]
  }
}

# Plot histogram of rolls
plot(table(likely_roll),                              # Values of the X,Y-Axis 
     col="chocolate", lwd=10,                         # Color of the entires, Linewidth = 10
     main = "Likelihood of Dices",                    # Diagram Title
     xlab = "Number of Dices",                        # X-Axis Title
     ylab = "Number of Experiments",                  # Y-Axis Title
     cex.lab = 1.5, cex.main = 1.5)                   # Font size of Titles 
                     
```


## Including Plots

```{r, echo=FALSE}

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
